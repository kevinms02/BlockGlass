<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlockGlass - Liquid Glass Puzzle</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="lobby-styles.css">
    <link rel="stylesheet" href="combo-effects.css">
    <script>
        window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
    </script>
    <script defer src="/_vercel/insights/script.js"></script>
</head>

<body>
    <!-- Lobby/Main Menu Screen -->
    <div id="lobbyScreen" class="lobby-screen">
        <div class="lobby-container">
            <!-- Settings Button for Lobby -->
            <button id="lobbySettingsButton" class="settings-button lobby-settings-button">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path
                        d="M12 1v6M12 17v6M4.22 4.22l4.24 4.24M15.54 15.54l4.24 4.24M1 12h6M17 12h6M4.22 19.78l4.24-4.24M15.54 8.46l4.24-4.24">
                    </path>
                </svg>
            </button>

            <div class="lobby-header">
                <h1 class="lobby-title">BlockGlass</h1>
                <!-- Version moved to footer -->
                <div id="lobbyHighScore" class="lobby-highscore hidden">
                    <div class="highscore-label">HIGH SCORE</div>
                    <div id="lobbyHighScoreValue" class="highscore-value">0</div>
                </div>
            </div>

            <div class="lobby-content">
                <div class="lobby-description">
                    Hi, Welcome to BlockGlass! This is game are still on a beta test. Hope you enjoy itðŸ˜‹
                    <br><br>
                    - Kevin The Creator
                </div>

                <button id="playButton" class="lobby-btn lobby-btn-primary">
                    <span class="lobby-btn-text">Play</span>
                    <svg class="lobby-btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                </button>
            </div>

            <div class="lobby-footer">
                <p class="lobby-creator">Created by <strong>Kevin Mahardyan Saputra</strong></p>
                <a href="https://instagram.com/kevinmahardyan" target="_blank" class="lobby-link">
                    <svg class="lobby-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                        <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                        <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
                    </svg>
                    @kevinmahardyan
                </a>
                <div class="lobby-version">BlockGlass Beta v1.5</div>
            </div>
        </div>
    </div>

    <!-- Game Container -->
    <div class="background-effects">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
    </div>

    <div class="game-container">
        <!-- Game Container -->
        <div id="gameContainer" class="game-container" style="display: none;">
            <!-- Back Button -->
            <button id="backButton" class="back-button">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7" />
                </svg>
            </button>

            <header class="game-header">
                <h1 class="game-title">
                    <span class="title-glass">Block</span><span class="title-accent">Glass</span>
                </h1>
                <!-- Settings Button -->
                <button id="settingsButton" class="settings-button">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path
                            d="M12 1v6M12 17v6M4.22 4.22l4.24 4.24M15.54 15.54l4.24 4.24M1 12h6M17 12h6M4.22 19.78l4.24-4.24M15.54 8.46l4.24-4.24">
                        </path>
                    </svg>
                </button>
            </header>

            <div class="stats-panel">
                <div class="stat-item">
                    <div class="stat-label">Score</div>
                    <div class="stat-value" id="score">0</div>
                </div>
                <div class="stat-item highlight">
                    <div class="stat-label">High Score</div>
                    <div class="stat-value" id="highScore">0</div>
                </div>
            </div>

            <!-- Combo Display -->
            <div id="comboDisplay" class="combo-display hidden">
                <span class="combo-text">COMBO</span>
                <span class="combo-value" id="comboValue">x2</span>
            </div>

            <!-- Praise Notification -->
            <div id="praiseNotification" class="praise-notification hidden"></div>

            <div class="game-board-container">
                <div class="grid-wrapper">
                    <div id="gameGrid" class="game-grid"></div>
                    <div id="particleContainer" class="particle-container"></div>
                </div>
            </div>

            <!-- Power-ups Panel -->
            <div class="powerups-panel">
                <div class="powerups-container">
                    <div class="powerup-item">
                        <button class="powerup-btn" id="bombPowerup" title="Destroy 3x3 area">
                            <span class="powerup-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path
                                        d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" />
                                </svg>
                            </span>
                            <span class="powerup-count" id="bombCount">2</span>
                        </button>
                        <span class="powerup-label">Bomb</span>
                    </div>

                    <div class="powerup-item">
                        <button class="powerup-btn" id="undoPowerup" title="Undo last move">
                            <span class="powerup-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M3 7v6h6M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13" />
                                </svg>
                            </span>
                            <span class="powerup-count" id="undoCount">2</span>
                        </button>
                        <span class="powerup-label">Undo</span>
                    </div>

                    <div class="powerup-item">
                        <button class="powerup-btn" id="fillPowerup" title="Fill single cell">
                            <span class="powerup-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                                </svg>
                            </span>
                            <span class="powerup-count" id="fillCount">2</span>
                        </button>
                        <span class="powerup-label">Fill</span>
                    </div>

                    <div class="powerup-item">
                        <button class="powerup-btn" id="rollPowerup" title="Reroll available blocks">
                            <span class="powerup-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path
                                        d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15" />
                                </svg>
                            </span>
                            <span class="powerup-count" id="rollCount">2</span>
                        </button>
                        <span class="powerup-label">Roll</span>
                    </div>
                </div>
            </div>

            <div class="blocks-panel">
                <div id="availableBlocks" class="available-blocks"></div>
            </div>
        </div>

        <!-- Game Over Modal -->
        <div id="gameOverModal" class="modal hidden">
            <div class="modal-content glass-panel">
                <h2 class="modal-title">Game Over!</h2>
                <div class="modal-stats">
                    <div class="modal-stat">
                        <span class="modal-stat-label">Final Score</span>
                        <span class="modal-stat-value" id="finalScore">0</span>
                    </div>
                    <div class="modal-stat">
                        <span class="modal-stat-label">Lines Cleared</span>
                        <span class="modal-stat-value" id="finalLines">0</span>
                    </div>
                    <div class="modal-stat" id="newHighScoreContainer" style="display: none;">
                        <span class="modal-stat-label">New High Score!</span>
                    </div>
                </div>

                <button id="restartBtn" class="restart-btn">Play Again</button>
                <button id="exitBtn" class="restart-btn exit-btn" style="margin-top: 12px;">Exit to Lobby</button>
            </div>
        </div>

        <!-- Save Me Countdown Popup -->
        <div id="saveMePopup" class="modal hidden">
            <div class="modal-content glass-panel save-me-panel">
                <h2 class="modal-title save-me-title">Last Chance!</h2>
                <div class="save-me-countdown-ring">
                    <svg viewBox="0 0 120 120" class="countdown-svg">
                        <circle class="countdown-bg" cx="60" cy="60" r="52" />
                        <circle class="countdown-progress" id="countdownCircle" cx="60" cy="60" r="52" />
                    </svg>
                    <span class="save-me-timer" id="saveMeTimer">5</span>
                </div>
                <button id="saveMeActionBtn" class="restart-btn save-me-action-btn">
                    Save Me!
                </button>
            </div>
        </div>

        <!-- Options Menu Modal -->
        <div id="optionsMenu" class="options-menu hidden">
            <div class="options-overlay"></div>
            <div class="options-modal">
                <h2 class="options-title">Game Menu</h2>
                <div class="options-buttons">
                    <button id="saveExitBtn" class="options-btn options-btn-primary">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                            <polyline points="7 3 7 8 15 8"></polyline>
                        </svg>
                        Exit
                    </button>
                    <button id="restartGameBtn" class="options-btn options-btn-danger">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="23 4 23 10 17 10"></polyline>
                            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                        </svg>
                        Restart
                    </button>
                    <button id="cancelOptionsBtn" class="options-btn options-btn-secondary">
                        Cancel
                    </button>
                </div>
            </div>
        </div>

        <!-- Restart Confirmation Modal -->
        <div id="restartConfirmationModal" class="options-menu hidden">
            <div class="options-overlay"></div>
            <div class="options-modal">
                <h2 class="options-title">Restart?</h2>
                <p style="color: rgba(255,255,255,0.8); text-align: center; margin-bottom: 24px; font-size: 1rem;">
                    Are you sure? This will clear your current progress.
                </p>
                <div class="options-buttons">
                    <button id="confirmRestartBtn" class="options-btn options-btn-danger">
                        Yes, Restart
                    </button>
                    <button id="cancelRestartBtn" class="options-btn options-btn-secondary">
                        Cancel
                    </button>
                </div>
            </div>
        </div>


        <!-- Combo Display -->
        <div id="comboDisplay" class="combo-display hidden">
            <div class="combo-text">COMBO</div>
            <div id="comboValue" class="combo-value">x2</div>
        </div>

        <!-- Praise Notification -->
        <div id="praiseNotification" class="praise-notification hidden"></div>

        <footer class="game-footer">
            <div class="footer-content">
                <span class="footer-version">v1.3</span>
                <span class="footer-divider">|</span>
                <span class="footer-creator">Created by <strong>Kevin Mahardyan Saputra</strong></span>
                <span class="footer-divider">|</span>
                <a href="https://instagram.com/kevinmahardyan" target="_blank" class="footer-link">
                    <svg class="footer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                        <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                        <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
                    </svg>
                    @kevinmahardyan
                </a>
            </div>
        </footer>
    </div>
    <!-- Close outer game-container -->

    <!-- Settings Modal - MUST be direct child of body for proper z-index stacking -->
    <div id="settingsModal" class="options-menu hidden">
        <div class="options-overlay"></div>
        <div class="options-modal">
            <div class="modal-header">
                <button id="closeSettingsBtn" class="modal-back-btn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7" />
                    </svg>
                </button>
                <h2 class="options-title" style="margin: 0;">Settings</h2>
            </div>
            <div class="settings-content">
                <div class="setting-item">
                    <div class="setting-label">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 18V5l12-2v13M6 15v3M6 15V5"></path>
                            <circle cx="6" cy="18" r="3"></circle>
                            <circle cx="18" cy="16" r="3"></circle>
                        </svg>
                        <span>Sound Effects</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="soundToggle" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div class="setting-label">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                            <path d="M2 17l10 5 10-5M2 12l10 5 10-5"></path>
                        </svg>
                        <span>Vibration</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="vibrationToggle" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
            <div class="options-buttons">
                <div style="width: 100%;">
                    <button id="feedbackBtn" class="options-btn options-btn-primary"
                        style="width: 100%; background: linear-gradient(135deg, #a855f7 0%, #d946ef 100%);">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            style="width: 20px; height: 20px;">
                            <path
                                d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 1 1-7.6-11.7 8.38 8.38 0 0 1 3.8.9L21 3z">
                            </path>
                        </svg>
                        Give Feedback
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Feedback Request Modal (Post-Game) -->
    <div id="feedbackModal" class="modal hidden">
        <div class="modal-content glass-panel feedback-panel">
            <div class="feedback-glow"></div>
            <h2 class="modal-title feedback-title">You're Amazing!</h2>
            <p class="feedback-text">
                Your skills are impressive! As a <b>Beta Tester</b>, your thoughts can help make BlockGlass even more
                legendary.
                <br><br>
                Mind sharing a quick bit of magic with us?
            </p>
            <div class="options-buttons">
                <button id="openFeedbackFormBtn" class="restart-btn feedback-action-btn">
                    Sure, let's do it!
                </button>
                <button id="skipFeedbackBtn" class="restart-btn exit-btn">
                    Maybe later
                </button>
            </div>
        </div>
    </div>

    <script src="game.js"></script>
</body>

</html>